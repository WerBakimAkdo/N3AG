<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Şifre Yenile</title>
<style>
body{display:flex;justify-content:center;align-items:center;height:100vh;background:#111;color:white;font-family:sans-serif;}
.container{background:#222;padding:30px;border-radius:20px;box-shadow:0 0 20px rgba(0,0,0,.5);}
input,button{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:none;}
button{background:#4caf50;color:white;font-weight:bold;cursor:pointer;}
button:hover{background:#45a049;}
</style>
</head>
<body>
<div class="container">
<h2>Yeni Şifre Belirle</h2>
<input type="hidden" id="userId" value="">
<input type="password" id="newPassword" placeholder="Yeni Şifre">
<button onclick="updatePassword()">Güncelle</button>
<p id="msg"></p>
</div>
<script>
const params = new URLSearchParams(window.location.search);
document.getElementById('userId').value = params.get('id');

async function updatePassword(){
  const userId = document.getElementById('userId').value;
  const newPassword = document.getElementById('newPassword').value;
  const res = await fetch('/sifre-guncelle',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ userId,newPassword })
  });
  const result = await res.json();
  document.getElementById('msg').innerText = result.message;
  if(result.success && result.redirect) setTimeout(()=>window.location.href=result.redirect,1500);
}
</script>
</body>
</html>
